<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Cleaning – Hiring CV Bias</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-8610558a007458a9b978551a034f4d85.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../pages/styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Hiring CV Bias</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../pages/01-problem.html"> 
<span class="menu-text">Problem Statement</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../pages/02-pipeline.html"> 
<span class="menu-text">Pipeline</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../pages/03-results.html"> 
<span class="menu-text">Results</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#raw-cvs-cleaning-steps" id="toc-raw-cvs-cleaning-steps" class="nav-link active" data-scroll-target="#raw-cvs-cleaning-steps">1. <strong>Raw CVs</strong> Cleaning Steps</a></li>
  <li><a href="#parsed-skills-the-cv_skills-dataframe-that-feeds-the-matcher" id="toc-parsed-skills-the-cv_skills-dataframe-that-feeds-the-matcher" class="nav-link" data-scroll-target="#parsed-skills-the-cv_skills-dataframe-that-feeds-the-matcher">2. <strong>Parsed Skills</strong> (the <code>cv_skills</code> DataFrame that feeds the matcher)</a></li>
  <li><a href="#matcher-results-output-csv-from-the-matching-algorithm" id="toc-matcher-results-output-csv-from-the-matching-algorithm" class="nav-link" data-scroll-target="#matcher-results-output-csv-from-the-matching-algorithm">3. <strong>Matcher Results</strong> (output CSV from the matching algorithm)</a></li>
  <li><a href="#exporting-the-cleaned-data" id="toc-exporting-the-cleaned-data" class="nav-link" data-scroll-target="#exporting-the-cleaned-data">Exporting the Cleaned Data</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Cleaning</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Main Objective:</strong><br>
In this notebook we inspect and clean missing or duplicate values in the three main datasets:</p>
<ol type="1">
<li><strong>Raw CVs</strong> (original, unstructured CV text)<br>
</li>
<li><strong>Parsed Skills</strong> (the <code>cv_skills</code> DataFrame that feeds the matcher)<br>
</li>
<li><strong>Matcher Results</strong> (output CSV from the matching algorithm)</li>
</ol>
<div id="1" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext autoreload </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>autoreload <span class="dv">2</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> hiring_cv_bias.cleaning.common <span class="im">import</span> (</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    cramers_v,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    filter_out_candidate_ids,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    find_dropped_skill_rows,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    inspect_missing,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    plot_cramer_matrix,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> hiring_cv_bias.cleaning.raw_cv <span class="im">import</span> (</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    add_length_column,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    assess_translation_completeness,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    detect_corrupted_cvs,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    detect_repetitive_cvs,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    detect_vocab_sparsity,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    filter_placeholder_tails,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    find_and_print_short_cvs,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    is_this_language,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    plot_length_histogram,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> hiring_cv_bias.config <span class="im">import</span> (</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    CANDIDATE_CVS_TRANSLATED_PATH,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    PARSED_DATA_PATH,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    REVERSE_MATCHING_PATH,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> hiring_cv_bias.utils <span class="im">import</span> (</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    filter_unknown_and_other_rows,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    load_data,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    load_excel_sheets,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload</code></pre>
</div>
</div>
<section id="raw-cvs-cleaning-steps" class="level2">
<h2 class="anchored" data-anchor-id="raw-cvs-cleaning-steps">1. <strong>Raw CVs</strong> Cleaning Steps</h2>
<section id="schema-load" class="level3">
<h3 class="anchored" data-anchor-id="schema-load">1. Schema &amp; Load</h3>
<ul>
<li>Define expected columns and data types (<code>CANDIDATE_ID: UInt64</code>, <code>CV_text_anon: String</code>, <code>Translated_CV: String</code>)<br>
</li>
<li>Load CSV into Polars DataFrame, verify row count matches the number of uniques Candidate IDs.</li>
<li>Check for duplicate <code>CANDIDATE_ID</code> entries -&gt; no duplicates found.</li>
</ul>
<div id="5" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>raw_cv <span class="op">=</span> load_data(CANDIDATE_CVS_TRANSLATED_PATH)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DataFrame schema:"</span>, raw_cv.schema)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded: </span><span class="sc">{</span>raw_cv<span class="sc">.</span>height<span class="sc">}</span><span class="ss"> CVs"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">################</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>total_rows <span class="op">=</span> raw_cv.height</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>unique_ids <span class="op">=</span> raw_cv.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).unique().height</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Unique CANDIDATE_ID: </span><span class="sc">{</span>unique_ids<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>display(raw_cv.sample(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame schema: Schema({'CANDIDATE_ID': Int64, 'CV_text_anon': String, 'Translated_CV': String})
Loaded: 7769 CVs
Unique CANDIDATE_ID: 7769</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">CANDIDATE_ID</th>
<th data-quarto-table-cell-role="th">CV_text_anon</th>
<th data-quarto-table-cell-role="th">Translated_CV</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>4376747</td>
<td>"Curriculum vitae INFORMAZIONI …</td>
<td>"curriculum vitae personal info…</td>
</tr>
<tr class="even">
<td>6479915</td>
<td>"CV anonimizzato: F O R M A T …</td>
<td>" European format for CV person…</td>
</tr>
<tr class="odd">
<td>6290282</td>
<td>"CV anonimizzato: """ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; C U…</td>
<td>" curriculum vitae personal inf…</td>
</tr>
<tr class="even">
<td>6109581</td>
<td>"CV anonimizzato: """ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DA…</td>
<td>" personal data born on 06.03.1…</td>
</tr>
<tr class="odd">
<td>6869415</td>
<td>"CV anonimizzato: """ Formato e…</td>
<td>" European format for CV person…</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="missing-value-inspection" class="level3">
<h3 class="anchored" data-anchor-id="missing-value-inspection">2. Missing Value Inspection</h3>
<ul>
<li>Count nulls per column (<code>null_count()</code>), compute percentage of missing values and report any columns with &gt; 0% missing</li>
</ul>
<div id="8" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>missing_stats <span class="op">=</span> inspect_missing(raw_cv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Missing value summary:
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">column</th>
<th data-quarto-table-cell-role="th">n_missing</th>
<th data-quarto-table-cell-role="th">pct_missing</th>
</tr>
<tr class="even">
<th>str</th>
<th>u32</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CANDIDATE_ID"</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>"CV_text_anon"</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>"Translated_CV"</td>
<td>0</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
No missing values detected in any column.</code></pre>
</div>
</div>
</section>
<section id="short--or-empty-cv-detection" class="level3">
<h3 class="anchored" data-anchor-id="short--or-empty-cv-detection">3. Short- or Empty-CV Detection</h3>
<p>Under this step we will:</p>
<ol type="1">
<li><strong>Empty / Whitespace-Only/ Very Short Text</strong>
<ul>
<li>Filter out any records where <code>CV_text_anon</code> is below a chosen threshold (e.g.&nbsp;300 characters), showing their IDs and snippets for manual review.</li>
</ul></li>
<li><strong>High Repetition / Low Structure</strong>
<ul>
<li>Split each CV into non-empty lines, count <code>n_lines</code> and <code>unique_lines</code>.<br>
</li>
<li>Compute <code>repetition_ratio = 1 − (unique_lines / n_lines)</code>.<br>
</li>
<li>Flag and drop any CVs with <code>repetition_ratio</code> above a threshold (e.g.&nbsp;&gt; 0.7).</li>
</ul></li>
</ol>
<p>These checks ensure we remove any CVs that are dominated by boilerplate before proceeding with further analysis.</p>
<div id="11" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plot_length_histogram(raw_cv, text_col<span class="op">=</span><span class="st">"CV_text_anon"</span>, bin_size<span class="op">=</span><span class="dv">300</span>, max_bin<span class="op">=</span><span class="dv">3000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="data_cleaning_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Remove Empty / Whitespace-Only/ Very Short Text</p>
<div id="13" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>raw_cv <span class="op">=</span> add_length_column(raw_cv, text_col<span class="op">=</span><span class="st">"CV_text_anon"</span>, length_col<span class="op">=</span><span class="st">"len_anon"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>too_short_df <span class="op">=</span> find_and_print_short_cvs(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    raw_cv,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    length_col<span class="op">=</span><span class="st">"len_anon"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    threshold<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    id_col<span class="op">=</span><span class="st">"CANDIDATE_ID"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    text_col<span class="op">=</span><span class="st">"CV_text_anon"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 77 CVs with CV_text_anon &lt; 300 chars. Showing up to 10:
 1. ID 7560889: 263 chars
 2. ID 7456101: 29 chars
 3. ID 7437776: 279 chars
 4. ID 7414638: 110 chars
 5. ID 7373536: 58 chars
 6. ID 7364629: 202 chars
 7. ID 7347338: 82 chars
 8. ID 7330315: 237 chars
 9. ID 7230306: 238 chars
 10. ID 7163148: 253 chars

Example full CV for ID 6562147:
'CV anonimizzato:\n"""\nINFORMAZIONI DI\nIndirizzo : Via Kuliscio\n"""'</code></pre>
</div>
</div>
<div id="14" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>short_cvs_ids <span class="op">=</span> too_short_df.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).to_series().to_list()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>raw_cv_cleaned <span class="op">=</span> filter_out_candidate_ids(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    raw_cv, short_cvs_ids, df_name<span class="op">=</span><span class="st">"CVs"</span>, description<span class="op">=</span><span class="st">"under 300 characters"</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CVs with under 300 characters: 77 out of 7769 total
That is 0.99% of all cvs
CVs -&gt; Original rows: 7769
CVs -&gt; Dropped rows:  77 (IDs in provided list)
CVs -&gt; Remaining rows: 7692</code></pre>
</div>
</div>
<p>Remove High Repetition / Low Structure CVs</p>
<div id="16" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>repetitive_cvs <span class="op">=</span> detect_repetitive_cvs(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    raw_cv_cleaned, text_col<span class="op">=</span><span class="st">"CV_text_anon"</span>, max_repetition<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span>repetitive_cvs<span class="sc">.</span>height<span class="sc">}</span><span class="ss"> repetitive CVs:"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>display(repetitive_cvs.select([<span class="st">"CANDIDATE_ID"</span>, <span class="st">"n_lines"</span>, <span class="st">"repetition_ratio"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 39 repetitive CVs:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (39, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">CANDIDATE_ID</th>
<th data-quarto-table-cell-role="th">n_lines</th>
<th data-quarto-table-cell-role="th">repetition_ratio</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7259455</td>
<td>244</td>
<td>0.553279</td>
</tr>
<tr class="even">
<td>7026944</td>
<td>105</td>
<td>0.971429</td>
</tr>
<tr class="odd">
<td>6981854</td>
<td>134</td>
<td>0.835821</td>
</tr>
<tr class="even">
<td>6876738</td>
<td>195</td>
<td>0.548718</td>
</tr>
<tr class="odd">
<td>6788013</td>
<td>103</td>
<td>0.514563</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>164616</td>
<td>401</td>
<td>0.992519</td>
</tr>
<tr class="even">
<td>153773</td>
<td>58</td>
<td>0.706897</td>
</tr>
<tr class="odd">
<td>125099</td>
<td>172</td>
<td>0.523256</td>
</tr>
<tr class="even">
<td>122003</td>
<td>205</td>
<td>0.965854</td>
</tr>
<tr class="odd">
<td>121482</td>
<td>151</td>
<td>0.695364</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="17" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>repetitive_cvs_ids <span class="op">=</span> repetitive_cvs.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).to_series().to_list()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>raw_cv_cleaned <span class="op">=</span> filter_out_candidate_ids(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    raw_cv_cleaned, repetitive_cvs_ids, df_name<span class="op">=</span><span class="st">"CVs"</span>, description<span class="op">=</span><span class="st">"repetitive CVs"</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CVs with repetitive CVs: 39 out of 7692 total
That is 0.51% of all cvs
CVs -&gt; Original rows: 7692
CVs -&gt; Dropped rows:  39 (IDs in provided list)
CVs -&gt; Remaining rows: 7653</code></pre>
</div>
</div>
</section>
<section id="text-quality-checks" class="level3">
<h3 class="anchored" data-anchor-id="text-quality-checks">4. Text Quality Checks</h3>
<p>To further ensure we filter out “bad” or malformed CVs, we will perform:</p>
<ol type="1">
<li><strong>Token &amp; Vocabulary Richness</strong>
<ul>
<li>Calculate the unique words / total words ratio to measure lexical variety.</li>
<li>Filter out CVs with very low number of unique words (e.g &lt; 20) or very low ratio (e.g.&nbsp;&lt; 0.2).</li>
</ul></li>
<li><strong>Detect Redacted‐Placeholder Tails</strong>
<ul>
<li>Flag any CV whose text ends with a long run of the same character (e.g.&nbsp;“XXXXXXXXXX…”), seen after manual inspection. These indicate fully redacted templates with no usable content and should be excluded.</li>
</ul></li>
<li><strong>Detect Garbled/Corrupted CVs</strong>
<ul>
<li>Compute the fraction of “unusual” characters (outside printable ASCII, Latin-1, or standard punctuation) in each CV. Flag and remove any CV where this fraction exceeds a small threshold (e.g.&nbsp;3%), catching heavily garbled or control-code–laden documents.</li>
</ul></li>
</ol>
<p>These additional checks will help us catch CVs that are too short, overly repetitive, structurally invalid, or otherwise unfit for reliable parsing and downstream analysis.</p>
<p><strong>Token &amp; Vocabulary Richness</strong></p>
<div id="21" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sparse_cvs <span class="op">=</span> detect_vocab_sparsity(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    raw_cv_cleaned, text_col<span class="op">=</span><span class="st">"CV_text_anon"</span>, min_words<span class="op">=</span><span class="dv">30</span>, min_ttr<span class="op">=</span><span class="fl">0.3</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"CVs to discard based on vocabulary sparsity: </span><span class="sc">{</span>sparse_cvs<span class="sc">.</span>height<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>display(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    sparse_cvs.select([<span class="st">"CANDIDATE_ID"</span>, <span class="st">"total_words"</span>, <span class="st">"unique_words"</span>, <span class="st">"ttr"</span>]).sort(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"ttr"</span>), descending<span class="op">=</span><span class="va">False</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CVs to discard based on vocabulary sparsity: 48</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (48, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">CANDIDATE_ID</th>
<th data-quarto-table-cell-role="th">total_words</th>
<th data-quarto-table-cell-role="th">unique_words</th>
<th data-quarto-table-cell-role="th">ttr</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6206994</td>
<td>1291</td>
<td>242</td>
<td>0.187452</td>
</tr>
<tr class="even">
<td>7080072</td>
<td>755</td>
<td>149</td>
<td>0.197351</td>
</tr>
<tr class="odd">
<td>6015186</td>
<td>931</td>
<td>191</td>
<td>0.205156</td>
</tr>
<tr class="even">
<td>6809297</td>
<td>462</td>
<td>101</td>
<td>0.218615</td>
</tr>
<tr class="odd">
<td>6987708</td>
<td>1621</td>
<td>375</td>
<td>0.231339</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>6501990</td>
<td>17</td>
<td>16</td>
<td>0.941176</td>
</tr>
<tr class="even">
<td>4479547</td>
<td>17</td>
<td>16</td>
<td>0.941176</td>
</tr>
<tr class="odd">
<td>3583383</td>
<td>22</td>
<td>21</td>
<td>0.954545</td>
</tr>
<tr class="even">
<td>6056802</td>
<td>27</td>
<td>26</td>
<td>0.962963</td>
</tr>
<tr class="odd">
<td>6099154</td>
<td>14</td>
<td>14</td>
<td>1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="22" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sparse_ids <span class="op">=</span> sparse_cvs.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).to_series().to_list()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>raw_cv_cleaned <span class="op">=</span> filter_out_candidate_ids(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    raw_cv_cleaned, sparse_ids, df_name<span class="op">=</span><span class="st">"CVs"</span>, description<span class="op">=</span><span class="st">"low lexical variety"</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CVs with low lexical variety: 48 out of 7653 total
That is 0.63% of all cvs
CVs -&gt; Original rows: 7653
CVs -&gt; Dropped rows:  48 (IDs in provided list)
CVs -&gt; Remaining rows: 7605</code></pre>
</div>
</div>
<p><strong>Detect Redacted‐Placeholder Tails</strong></p>
<div id="24" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>placeholder_cvs <span class="op">=</span> filter_placeholder_tails(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    raw_cv_cleaned, text_col<span class="op">=</span><span class="st">"CV_text_anon"</span>, char<span class="op">=</span><span class="st">"X"</span>, min_run<span class="op">=</span><span class="dv">20</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span>placeholder_cvs<span class="sc">.</span>height<span class="sc">}</span><span class="ss"> CVs with trailing X placeholders:"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>display(placeholder_cvs.select([<span class="st">"CANDIDATE_ID"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 52 CVs with trailing X placeholders:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (52, 1)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">CANDIDATE_ID</th>
</tr>
<tr class="even">
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7471471</td>
</tr>
<tr class="even">
<td>7423990</td>
</tr>
<tr class="odd">
<td>7386710</td>
</tr>
<tr class="even">
<td>7295445</td>
</tr>
<tr class="odd">
<td>7228164</td>
</tr>
<tr class="even">
<td>…</td>
</tr>
<tr class="odd">
<td>166297</td>
</tr>
<tr class="even">
<td>156390</td>
</tr>
<tr class="odd">
<td>151354</td>
</tr>
<tr class="even">
<td>146771</td>
</tr>
<tr class="odd">
<td>118642</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="25" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>placeholder_ids <span class="op">=</span> placeholder_cvs.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).to_series().to_list()</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>raw_cv_cleaned <span class="op">=</span> filter_out_candidate_ids(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    raw_cv_cleaned,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    placeholder_ids,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    df_name<span class="op">=</span><span class="st">"CVs"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    description<span class="op">=</span><span class="st">"trailing X placeholders"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CVs with trailing X placeholders: 52 out of 7605 total
That is 0.68% of all cvs
CVs -&gt; Original rows: 7605
CVs -&gt; Dropped rows:  52 (IDs in provided list)
CVs -&gt; Remaining rows: 7553</code></pre>
</div>
</div>
<p><strong>Detect Garbled/Corrupted CVs</strong></p>
<div id="27" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>corrupted_cvs <span class="op">=</span> detect_corrupted_cvs(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    raw_cv_cleaned, text_col<span class="op">=</span><span class="st">"CV_text_anon"</span>, max_unusual_frac<span class="op">=</span><span class="fl">0.02</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Corrupted CVs to discard: </span><span class="sc">{</span>corrupted_cvs<span class="sc">.</span>height<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>display(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    corrupted_cvs.select([<span class="st">"CANDIDATE_ID"</span>, <span class="st">"unusual_frac"</span>]).sort(</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"unusual_frac"</span>, descending<span class="op">=</span><span class="va">True</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Corrupted CVs to discard: 14</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (14, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">CANDIDATE_ID</th>
<th data-quarto-table-cell-role="th">unusual_frac</th>
</tr>
<tr class="even">
<th>i64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7265646</td>
<td>0.71831</td>
</tr>
<tr class="even">
<td>7442026</td>
<td>0.683837</td>
</tr>
<tr class="odd">
<td>2963734</td>
<td>0.218973</td>
</tr>
<tr class="even">
<td>4624374</td>
<td>0.044884</td>
</tr>
<tr class="odd">
<td>6745849</td>
<td>0.043478</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>7242049</td>
<td>0.021448</td>
</tr>
<tr class="even">
<td>7133277</td>
<td>0.021265</td>
</tr>
<tr class="odd">
<td>6899819</td>
<td>0.021021</td>
</tr>
<tr class="even">
<td>5400351</td>
<td>0.020385</td>
</tr>
<tr class="odd">
<td>6056462</td>
<td>0.020049</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="28" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>corrupted_ids <span class="op">=</span> corrupted_cvs.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).to_series().to_list()</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>raw_cv_cleaned <span class="op">=</span> filter_out_candidate_ids(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    raw_cv_cleaned, corrupted_ids, df_name<span class="op">=</span><span class="st">"CVs"</span>, description<span class="op">=</span><span class="st">"corrupted symbols"</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CVs with corrupted symbols: 14 out of 7553 total
That is 0.19% of all cvs
CVs -&gt; Original rows: 7553
CVs -&gt; Dropped rows:  14 (IDs in provided list)
CVs -&gt; Remaining rows: 7539</code></pre>
</div>
</div>
</section>
<section id="translation-completeness" class="level3">
<h3 class="anchored" data-anchor-id="translation-completeness">5. <strong>Translation Completeness</strong></h3>
<ul>
<li><strong>Filter Out Poor Translations</strong><br>
Compute len_ratio = <code>len(Translated_CV) / len(CV_text_anon)</code> and flag any CV with <br> <code>len_ratio &lt; 0.7</code> (e.g.&nbsp;single-character outputs or garbled text) or an empty/missing translation. <br></li>
</ul>
<p>Since these cases are very rare, we drop them outright instead of attempting a fallback or re-translation.</p>
<div id="31" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>translation_stats_df <span class="op">=</span> assess_translation_completeness(raw_cv_cleaned)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>display(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    translation_stats_df.<span class="bu">filter</span>(pl.col(<span class="st">"len_ratio"</span>) <span class="op">&lt;</span> <span class="fl">0.7</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    .select([<span class="st">"CANDIDATE_ID"</span>, <span class="st">"orig_len"</span>, <span class="st">"trans_len"</span>, <span class="st">"len_ratio"</span>])</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    .sort(<span class="st">"len_ratio"</span>, descending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (18, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">CANDIDATE_ID</th>
<th data-quarto-table-cell-role="th">orig_len</th>
<th data-quarto-table-cell-role="th">trans_len</th>
<th data-quarto-table-cell-role="th">len_ratio</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7164534</td>
<td>6328</td>
<td>107</td>
<td>0.016909</td>
</tr>
<tr class="even">
<td>158927</td>
<td>2700</td>
<td>139</td>
<td>0.051481</td>
</tr>
<tr class="odd">
<td>127945</td>
<td>1736</td>
<td>798</td>
<td>0.459677</td>
</tr>
<tr class="even">
<td>6661398</td>
<td>3130</td>
<td>1731</td>
<td>0.553035</td>
</tr>
<tr class="odd">
<td>7303615</td>
<td>1134</td>
<td>661</td>
<td>0.582892</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>5964952</td>
<td>2017</td>
<td>1325</td>
<td>0.656916</td>
</tr>
<tr class="even">
<td>5871851</td>
<td>5450</td>
<td>3636</td>
<td>0.667156</td>
</tr>
<tr class="odd">
<td>6278055</td>
<td>330</td>
<td>223</td>
<td>0.675758</td>
</tr>
<tr class="even">
<td>1009832</td>
<td>4821</td>
<td>3332</td>
<td>0.691143</td>
</tr>
<tr class="odd">
<td>6200024</td>
<td>1442</td>
<td>997</td>
<td>0.691401</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="32" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>low_translation_ids <span class="op">=</span> (</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    translation_stats_df.<span class="bu">filter</span>(pl.col(<span class="st">"len_ratio"</span>) <span class="op">&lt;</span> <span class="fl">0.7</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    .select(<span class="st">"CANDIDATE_ID"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    .to_series()</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    .to_list()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>raw_cv_cleaned <span class="op">=</span> filter_out_candidate_ids(</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    raw_cv_cleaned,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    low_translation_ids,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    df_name<span class="op">=</span><span class="st">"CVs"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    description<span class="op">=</span><span class="st">"low translation completeness"</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CVs with low translation completeness: 18 out of 7539 total
That is 0.24% of all cvs
CVs -&gt; Original rows: 7539
CVs -&gt; Dropped rows:  18 (IDs in provided list)
CVs -&gt; Remaining rows: 7521</code></pre>
</div>
</div>
<p>We ran our language‐detection check on the <strong>Italian</strong> <code>CV_text_anon</code> and found <strong>155</strong> records flagged as “not Italian.”</p>
<p><strong>Since our downstream analysis relies exclusively on the English translations</strong>, we’re not going to drop these files. Instead, we will now verify that the <strong><code>Translated_CV</code></strong> column truly contains English text before proceeding with bias and skill‐extraction analyses.</p>
<div id="34" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>not_italian_df <span class="op">=</span> (</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    raw_cv_cleaned.with_columns(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>            pl.col(<span class="st">"CV_text_anon"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>            .map_elements(</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                <span class="kw">lambda</span> s, <span class="op">*</span>_: <span class="kw">not</span> is_this_language(s <span class="kw">or</span> <span class="st">""</span>, <span class="st">"it"</span>),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                return_dtype<span class="op">=</span>pl.Boolean,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>            .alias(<span class="st">"not_italian"</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    .select([<span class="st">"CANDIDATE_ID"</span>, <span class="st">"CV_text_anon"</span>, <span class="st">"not_italian"</span>])</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(pl.col(<span class="st">"not_italian"</span>))</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span>not_italian_df<span class="sc">.</span>height<span class="sc">}</span><span class="ss"> CVs not in Italian."</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>display(not_italian_df.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 153 CVs not in Italian.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">CANDIDATE_ID</th>
<th data-quarto-table-cell-role="th">CV_text_anon</th>
<th data-quarto-table-cell-role="th">not_italian</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>bool</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7931173</td>
<td>"CV anonimizzato: """ PERSONAL …</td>
<td>true</td>
</tr>
<tr class="even">
<td>7927173</td>
<td>"CV anonimizzato: """ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PER…</td>
<td>true</td>
</tr>
<tr class="odd">
<td>7926185</td>
<td>"CV: """ E U R O P E A N C U R …</td>
<td>true</td>
</tr>
<tr class="even">
<td>7734475</td>
<td>"CV anonimizzato: """ Content D…</td>
<td>true</td>
</tr>
<tr class="odd">
<td>7560905</td>
<td>"CV anonimizzato: """ PROFILE L…</td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="35" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sample CVs not in Italian:"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(not_italian_df.sample(<span class="dv">1</span>)[<span class="st">"CV_text_anon"</span>].item())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample CVs not in Italian:
CV:
"""
EDUCATION
Liceo E. Fermi (Cantù – Italy)
Diploma: “Maturità scientifica” completed in 1984. 
WORK EXPERIENCE
    April 2016
    -
    Present
Adotta : company leader in the market for production of office furniture (Partition walls/ furniture and equipped workstation). 
Position: Sales Manager , in charge of Foreign Customers, managing 7 resources, Based in Washington DC office. Main Duties:
Definition of export strategies and sales plans;
Consolidation of exiting relationships with customer in American, Canada, Central America and South American markets; 
Management of communication flows with the customer for information on various orders and their progress;
Accurate assessment of internal and external logistics for the organization of shipments, resolution of issues concerning goods delivery.
    December 2015
    -
    March 2016
IVM S.p.A.: company leader in the market for production of office furniture (Partition walls/ furniture and equipped workstation). 
Position: Export Manager.
October 1999
-
    November 2015
Citterio S .p.A. ( Molteni &amp; C. SPA group): company leader in the production of office furniture (Partition walls/furniture and equipped workstations).
Positions: Export Manager, in charge of Italian and Foreign Customers, managing three resources. Main duties:
Definition of export strategies and sales plans;
Fostering relationships with major customers, distributors and agents;
Consolidation of existing relationships with customers in the European, American, Asian, Middle-Eastern and Australian markets, providing them with the necessary technical and commercial assistance;
Creation and organization of a network of agents and dealers, providing the necessary support and training
Control of customer credit lines and any guarantees required;
Management of communication flows with the customer for information on various orders and their progress;
Accurate assessment of internal and external logistics for the organization of shipments, resolution of issues concerning goods delivery.
September 1994
-
September 1999
All Over S.r.l. designs studio for printed fabrics
Position: Sales Manager. Main duties:
excellent experience in entertaining relationships with major Italian customers;
opening new markets in the Middle and Far East, increasing the development and growth of the turnover;
Consolidation of relations with existing customers in the European, American markets, providing them with the necessary technical and commercial assistance;
Creation and organization of a network of agents and dealers, providing the necessary support and training.
February 1992
-
September 1994
Elle 2 S.r.l. designs studio for printed fabrics
Position: Area Manager for the Italian, European and Japanese markets. 
Until
February 1992
Sales agent for publishing products and software.
    FOREIGN LANGUAGES
English (fluent), Spanish (fluent), French (good). 
    COMPUTER SKILLS
Good experience in computer use and knowledge of the most used office automation softwares (Windows 10, MS Word , MS Excel, MS Power Point, AS400, AutoCAD 2015) .
    OTHER 
    SKILLS
Excellent suitability to human co ntacts and teamwork.
Flexibility and orientation to problem solving.
Ability to work on targets and in stressful situations.
"""</code></pre>
</div>
</div>
<div id="36" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>not_english_df <span class="op">=</span> (</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    raw_cv_cleaned.with_columns(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>            pl.col(<span class="st">"Translated_CV"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>            .map_elements(</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                <span class="kw">lambda</span> s, <span class="op">*</span>_: <span class="kw">not</span> is_this_language(s <span class="kw">or</span> <span class="st">""</span>, <span class="st">"en"</span>),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>                return_dtype<span class="op">=</span>pl.Boolean,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>            .alias(<span class="st">"not_english"</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    .select([<span class="st">"CANDIDATE_ID"</span>, <span class="st">"Translated_CV"</span>, <span class="st">"not_english"</span>])</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(pl.col(<span class="st">"not_english"</span>))</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span>not_english_df<span class="sc">.</span>height<span class="sc">}</span><span class="ss"> CVs not in English."</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>display(not_english_df.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 16 CVs not in English.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">CANDIDATE_ID</th>
<th data-quarto-table-cell-role="th">Translated_CV</th>
<th data-quarto-table-cell-role="th">not_english</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>bool</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7546519</td>
<td>" gender male birthdate 18/10/1…</td>
<td>true</td>
</tr>
<tr class="even">
<td>7292989</td>
<td>" work experience 10/15/2015 – …</td>
<td>true</td>
</tr>
<tr class="odd">
<td>7282933</td>
<td>" f o r m a t o e u r o p e o p…</td>
<td>true</td>
</tr>
<tr class="even">
<td>7130948</td>
<td>" professional experience ener …</td>
<td>true</td>
</tr>
<tr class="odd">
<td>6871809</td>
<td>" experience bartender/barista …</td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="37" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sample CVs not in English:"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(not_english_df.sample(<span class="dv">1</span>)[<span class="st">"Translated_CV"</span>].item())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample CVs not in English:
 timetables and maps of bus line 725 view on a web page 725 genova brignole bus line 725 (genova brignole) has 2 routes. during the week it is operational: (1) genova brignole: 05:04 - 20:04 (2) torriglia (→ scoffera): 06:30 - 20:30 use moovit to find the bus line 725 stops closest to you and find out when the next bus line 725 will pass in the direction of: genova brignole bus line 725 timetables departure times to genova brignole: 55 stops view the timetables for the line monday 05:04 - 20:04 tuesday 05:04 - 20:04 torriglia / rimessa wednesday 05:04 - 20:04 torriglia, piazza piaggio thursday 05:04 - 20:04 costa / laccetto friday 05:04 - 20:04 prato / rosciano saturday 05:04 - 20:04 laccio / strada nuova sunday 06:34 - 20:04 laccio / junction cavorsi - provincial depot passo della scoffera via scoffera / civ. 60 information on bus line 725 direction: genoa brignole via scoffera / civ. 38 stops: 55 journey time: 69 min sottocolle / from u bisaccia the line in brief: loc. sottocolle loc. fossa loc. piancarnasse loc. ferruccio loc. rapallin / former depot loc. rapallin bargagli / via martini 29 bargagli / carabinieri - s. alberto junction bargagli / pharmacy terminus bargagli center loc. rollavariante di traso trapena / florist via dei partigiani / f. 28 via dei partigiani / junction viganego loc. the capture via bavari / sherwood refuge crossroads for davagna via bavari / stoppani via bavari / house cantoniera prato / pian martello (terminus) struppa 1 / benedetto da porto struppa 3 / trossarelli struppa 5 / creto struppa 6 / doria struppa 7 / lucarno struppa 8 / ligorna struppa 10 / tour of fullo molassana 3 / gherzi molassana 4 / geirato molassana 5 / emilia piacenza 1 / rocca piacenza 3 / san gottardo piacenza 5 / bridge feritare piacenza 6 / san sebastiano piacenza 8 / bridge veronelli piacenza 11 / resasco piacenza 12 / cemetery staglieno bobbio 2 / montaldo bobbio 4 / bridge bobbio 5 / stadium canevari 1 / romagnosi canevari 2 / piazza firpo canevari 4/sant&amp;#39;agata metrogenova brignole / zaninetta terminaldirection: torriglia (→ scoffera) timetables of bus line 725 departure times torriglia (→ scoffera): 54 stops view the timetables of the line monday 06:30 - 20:30 tuesday 06:30 - 20:30 genova brignole / zaninetta terminal wednesday 06:30 - 20:30 canevari/sant&amp;#39;agata metro thursday 06:30 - 20:30 moresco 2/romagnosi friday 06:30 - 20:30 monnet/stadio saturday 06:30 - 20:30 bobbio 2/pontetto sunday 06:00 - 21:15 bobbio 4/montaldo piacenza 1/staglieno cemetery piacenza 5/ponte veronelli information on bus line 725 direction: torriglia (→ scoffera) piacenza 7/san sebastiano stops: 54 journey time: 65 min emilia 2/fossato cicala the line in brief: emilia 4/sciorba emilia 6/rocca emilia 7/molassana molassana 2/geirato molassana 3/gherzi struppa 3/ligorna struppa 4/lucarno struppa 5/doria struppa 7/rosata struppa 8/trossarelli struppa 10/suppini prato / pian martello (terminus) via bavari, 2 via bavari / loc. tane stoppani via bavari / junction for davagna via bavari / sherwood refuge loc. la presa via dei partigiani / viganego junction via dei partigianiloc. trapena florist loc. trapena via cevasco 17 / traso variant locality rolla bargagli / municipality (center) bargagli / pharmacy bargagli / carabinieri - s. alberto junction bargagli / via martini 64 loc. rapallin loc. rapallin / former garage loc. ferruccio loc. piancarnasse loc. fossa sottocolle / junction for chiavari sottocolle / from u bisaccia via scoffera / street number 43 via scoffera / street number 60 passo della scoffera laccio / junction cavorsi - provincial depot laccio / new road locality prato prato / rosciano costa / laccetto torriglia, piazza piaggio torriglia / garagetimetables, maps and stops of bus line 725 available in a pdf on moovitapp.com. use moovit app to get real wait times, schedules check arrival times on all other lines or step-by-step directions to get around by public transport in genoa and savona. real time discover moovit solutions maas available countries mooviter community © 2022 moovit - all rights reserved </code></pre>
</div>
</div>
<p>We ran our check on the <strong>Translated_CV</strong> column and found only <strong>16</strong> records flagged as non-English. After a manual review, we discovered that these CVs are indeed written in English but include many Italian place names, addresses and organization titles which skew the language detector’s statistics. Since the underlying text is English and these cases are few, we will <strong>not</strong> drop them.</p>
<blockquote class="blockquote">
<p><strong>Note:</strong> going forward, all regex or pattern-based quality checks should be applied <strong>only</strong> to the <strong>English</strong> <code>Translated_CV</code> field.</p>
</blockquote>
</section>
<section id="handling-empty-cv-records" class="level3">
<h3 class="anchored" data-anchor-id="handling-empty-cv-records">6. <strong>Handling Empty CV Records</strong></h3>
<p>During our inspection we found many corrupted CVs. <br> In each dedicated section, to ensure data quality and consistency across all our analyses, we will:</p>
<ol type="1">
<li><p><strong>Exclude their parsed skills</strong><br>
Filter out any rows in our parsed skills DataFrame (<code>cv_skills</code>) corresponding to those same <code>CANDIDATE_ID</code>s.</p></li>
<li><p><strong>Omit their entries in the Reverse Matching results</strong><br>
Drop records in the Reverse Matching dataset (<code>ReverseMatching.xlsx</code>) for those candidate IDs.</p></li>
</ol>
<p>This cleanup step prevents entirely missing CVs from biasing our skill‐extraction and matching analyses.</p>
</section>
</section>
<section id="parsed-skills-the-cv_skills-dataframe-that-feeds-the-matcher" class="level2">
<h2 class="anchored" data-anchor-id="parsed-skills-the-cv_skills-dataframe-that-feeds-the-matcher">2. <strong>Parsed Skills</strong> (the <code>cv_skills</code> DataFrame that feeds the matcher)</h2>
<section id="schema-load-1" class="level3">
<h3 class="anchored" data-anchor-id="schema-load-1">1. Schema &amp; Load</h3>
<div id="43" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>raw_cv <span class="op">=</span> load_data(CANDIDATE_CVS_TRANSLATED_PATH)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>raw_skills <span class="op">=</span> load_data(PARSED_DATA_PATH)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DataFrame schema:"</span>, raw_skills.schema)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded: </span><span class="sc">{</span>raw_skills<span class="sc">.</span>height<span class="sc">}</span><span class="ss"> Skills"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">################</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>total_rows <span class="op">=</span> raw_skills.height</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>unique_ids <span class="op">=</span> raw_skills.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).unique().height</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Unique CANDIDATE_ID: </span><span class="sc">{</span>unique_ids<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame schema: Schema({'CANDIDATE_ID': Int64, 'Skill': String, 'Skill_Type': String})
Loaded: 132985 Skills
Unique CANDIDATE_ID: 7769</code></pre>
</div>
</div>
<p>Exclude parsed skills of the candidates with corrupted CVs.</p>
<div id="45" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>raw_cv_ids <span class="op">=</span> raw_cv.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).to_series().to_list()</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of CVs loaded -&gt;"</span>, <span class="bu">len</span>(raw_cv_ids))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>raw_cv_cleaned_ids <span class="op">=</span> raw_cv_cleaned.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).to_series().to_list()</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Number of CVs kept after cleaning -&gt;"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">len</span>(raw_cv_cleaned_ids),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>raw_cv_deleted_ids <span class="op">=</span> (</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    raw_cv.<span class="bu">filter</span>(<span class="op">~</span>pl.col(<span class="st">"CANDIDATE_ID"</span>).is_in(raw_cv_cleaned_ids))</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    .select(pl.col(<span class="st">"CANDIDATE_ID"</span>))</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    .to_series()</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    .to_list()</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Number of CVs deleted -&gt;"</span>,</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">len</span>(raw_cv_deleted_ids),</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of CVs loaded -&gt; 7769
Number of CVs kept after cleaning -&gt; 7521
Number of CVs deleted -&gt; 248</code></pre>
</div>
</div>
<div id="46" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>raw_skills_cleaned <span class="op">=</span> filter_out_candidate_ids(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    raw_skills, raw_cv_deleted_ids, df_name<span class="op">=</span><span class="st">"Skills"</span>, description<span class="op">=</span><span class="st">"CVs deleted"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co">##################</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity check on the new number of unique candidate IDs.</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>total_rows <span class="op">=</span> raw_skills_cleaned.height</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>unique_ids <span class="op">=</span> raw_skills_cleaned.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).unique().height</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Unique CANDIDATE_ID: </span><span class="sc">{</span>unique_ids<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Skills with CVs deleted: 4086 out of 132985 total
That is 3.07% of all skills
Skills -&gt; Original rows: 132985
Skills -&gt; Dropped rows:  4086 (IDs in provided list)
Skills -&gt; Remaining rows: 128899
Unique CANDIDATE_ID: 7521</code></pre>
</div>
</div>
</section>
<section id="missing-value-inspection-1" class="level3">
<h3 class="anchored" data-anchor-id="missing-value-inspection-1">2. Missing Value Inspection</h3>
<div id="48" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>missing_skills <span class="op">=</span> inspect_missing(raw_skills_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Missing value summary:
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">column</th>
<th data-quarto-table-cell-role="th">n_missing</th>
<th data-quarto-table-cell-role="th">pct_missing</th>
</tr>
<tr class="even">
<th>str</th>
<th>u32</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CANDIDATE_ID"</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>"Skill"</td>
<td>82</td>
<td>0.06</td>
</tr>
<tr class="odd">
<td>"Skill_Type"</td>
<td>0</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Columns with &gt; 0% missing values:
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">column</th>
<th data-quarto-table-cell-role="th">n_missing</th>
<th data-quarto-table-cell-role="th">pct_missing</th>
</tr>
<tr class="even">
<th>str</th>
<th>u32</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Skill"</td>
<td>82</td>
<td>0.06</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Inspecting missing values we’ve found that 82 rows are missing a <code>Skill</code> value. Diving into the data, we see that these rows are all associated with the value <code>DRIVERSLIC</code> in the <code>Skill_Type</code> column. <br> This indicates that these rows are likely placeholders for driver license information, which is however useful to our analysis. <br> We will <strong>not</strong> drop these rows from the dataset.</p>
<p><strong>Remove Missing or Null Skills</strong></p>
<div id="51" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>invalid_rows <span class="op">=</span> raw_skills_cleaned.<span class="bu">filter</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"Skill"</span>).is_null() <span class="op">&amp;</span> (pl.col(<span class="st">"Skill_Type"</span>) <span class="op">!=</span> <span class="st">"DRIVERSLIC"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span>invalid_rows<span class="sc">.</span>height<span class="sc">}</span><span class="ss"> rows with missing Skill (excluding DRIVERSLIC):"</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>display(invalid_rows)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co">##################</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>raw_skills_cleaned <span class="op">=</span> raw_skills_cleaned.<span class="bu">filter</span>(</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">~</span>(pl.col(<span class="st">"Skill"</span>).is_null() <span class="op">&amp;</span> (pl.col(<span class="st">"Skill_Type"</span>) <span class="op">!=</span> <span class="st">"DRIVERSLIC"</span>))</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"After dropping invalid rows, </span><span class="sc">{</span>raw_skills_cleaned<span class="sc">.</span>height<span class="sc">}</span><span class="ss"> skill records remain."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 1 rows with missing Skill (excluding DRIVERSLIC):</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">CANDIDATE_ID</th>
<th data-quarto-table-cell-role="th">Skill</th>
<th data-quarto-table-cell-role="th">Skill_Type</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5107653</td>
<td>null</td>
<td>"Language_Skill"</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>After dropping invalid rows, 128898 skill records remain.</code></pre>
</div>
</div>
</section>
<section id="find-exact-duplicate" class="level3">
<h3 class="anchored" data-anchor-id="find-exact-duplicate">3. Find exact duplicate</h3>
<div id="53" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>total_before <span class="op">=</span> raw_skills_cleaned.height</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>unique_before <span class="op">=</span> raw_skills_cleaned.unique(subset<span class="op">=</span>[<span class="st">"CANDIDATE_ID"</span>, <span class="st">"Skill"</span>]).height</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total rows: </span><span class="sc">{</span>total_before<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Unique (ID, Skill, Skill_Type): </span><span class="sc">{</span>unique_before<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co">##################</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> total_before <span class="op">!=</span> unique_before:</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    raw_skills_cleaned <span class="op">=</span> raw_skills_cleaned.unique(subset<span class="op">=</span>[<span class="st">"CANDIDATE_ID"</span>, <span class="st">"Skill"</span>])</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Dropped </span><span class="sc">{</span>total_before <span class="op">-</span> unique_before<span class="sc">}</span><span class="ss"> duplicates."</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"No duplicates found—skipping deduplication."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total rows: 128898
Unique (ID, Skill, Skill_Type): 128898
No duplicates found—skipping deduplication.</code></pre>
</div>
</div>
</section>
<section id="validate-skill-types" class="level3">
<h3 class="anchored" data-anchor-id="validate-skill-types">4. Validate Skill Types</h3>
<ul>
<li>Ensure Skill_Type only takes one of your known categories (<code>IT_Skill</code>, <code>Job_title</code>, <code>Language_Skill</code>, <code>Professional_Skill</code>, <code>DRIVERSLIC</code>).</li>
</ul>
<div id="56" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>VALID_TYPES <span class="op">=</span> [</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"IT_Skill"</span>,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Job_title"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Language_Skill"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Professional_Skill"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"DRIVERSLIC"</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>all_types <span class="op">=</span> raw_skills_cleaned.select(<span class="st">"Skill_Type"</span>).unique().to_series().to_list()</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>invalid_types <span class="op">=</span> [t <span class="cf">for</span> t <span class="kw">in</span> all_types <span class="cf">if</span> t <span class="kw">not</span> <span class="kw">in</span> VALID_TYPES]</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co">##############</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> invalid_types:</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Found invalid Skill_Type values:"</span>)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> invalid_types:</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"  -"</span>, t)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"All Skill_Type values are valid."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>All Skill_Type values are valid.</code></pre>
</div>
</div>
</section>
<section id="filter-out-garbage-skill-tokens" class="level3">
<h3 class="anchored" data-anchor-id="filter-out-garbage-skill-tokens">5. Filter Out Garbage Skill Tokens</h3>
<ul>
<li>Drop any <code>Skill</code> entries that are obviously malformed (e.g.&nbsp;length &lt; 2 or &gt; 100, only punctuation or digits).<br>
</li>
<li>Optionally remove entries matching placeholder patterns (like a long run of <code>X</code>).</li>
</ul>
<div id="59" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>dropped_skills <span class="op">=</span> find_dropped_skill_rows(raw_skills)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dropped </span><span class="sc">{</span>dropped_skills<span class="sc">.</span>height<span class="sc">}</span><span class="ss"> skill rows:"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>display(dropped_skills.head(<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dropped 88 skill rows:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (10, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">CANDIDATE_ID</th>
<th data-quarto-table-cell-role="th">Skill</th>
<th data-quarto-table-cell-role="th">Skill_Type</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7747553</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="even">
<td>7583771</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="odd">
<td>7527802</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="even">
<td>7484890</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="odd">
<td>7456557</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="even">
<td>7422185</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="odd">
<td>7413665</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="even">
<td>7347469</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="odd">
<td>7164548</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="even">
<td>7099403</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="60" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>display(dropped_skills.<span class="bu">filter</span>(pl.col(<span class="st">"Skill_Type"</span>) <span class="op">==</span> <span class="st">"DRIVERSLIC"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (87, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">CANDIDATE_ID</th>
<th data-quarto-table-cell-role="th">Skill</th>
<th data-quarto-table-cell-role="th">Skill_Type</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7747553</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="even">
<td>7583771</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="odd">
<td>7527802</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="even">
<td>7484890</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="odd">
<td>7456557</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>124012</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="even">
<td>123094</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="odd">
<td>117943</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="even">
<td>117855</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
<tr class="odd">
<td>42289</td>
<td>null</td>
<td>"DRIVERSLIC"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>All the dropped_skills would be DRIVERSLIC, so we will <strong>not</strong> drop any rows from the skills, as previously discussed.</p>
</section>
</section>
<section id="matcher-results-output-csv-from-the-matching-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="matcher-results-output-csv-from-the-matching-algorithm">3. <strong>Matcher Results</strong> (output CSV from the matching algorithm)</h2>
<div id="63" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>reversed_skills_matching_dict <span class="op">=</span> load_excel_sheets(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    REVERSE_MATCHING_PATH, sheets<span class="op">=</span>[<span class="st">"Candidates"</span>]</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>reversed_skills_matching <span class="op">=</span> reversed_skills_matching_dict[<span class="st">"Candidates"</span>]</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DataFrame schema:"</span>, reversed_skills_matching.schema)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded: </span><span class="sc">{</span>reversed_skills_matching<span class="sc">.</span>height<span class="sc">}</span><span class="ss"> candidates"</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">################</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>total_rows <span class="op">=</span> reversed_skills_matching.height</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>unique_ids <span class="op">=</span> reversed_skills_matching.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).unique().height</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Unique CANDIDATE_ID: </span><span class="sc">{</span>unique_ids<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame schema: Schema({'CANDIDATE_ID': Int64, 'Gender': String, 'Age_bucket': String, 'professional_categories_int': String, 'matterknowledges': String, 'languages': String, 'regulatedtrainings': String, 'candidatecity': String, 'drivinglicenses': String, 'LONGITUDE': Float64, 'LATITUDE': Float64, 'experience': String})
Loaded: 7769 candidates
Unique CANDIDATE_ID: 7769</code></pre>
</div>
</div>
<div id="64" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>reversed_skills_matching <span class="op">=</span> filter_out_candidate_ids(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    reversed_skills_matching,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    raw_cv_deleted_ids,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    df_name<span class="op">=</span><span class="st">"Reverse Matchhing Candidates"</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    description<span class="op">=</span><span class="st">"CVs deleted"</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co">##################</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity check on the new number of unique candidate IDs.</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>total_rows <span class="op">=</span> reversed_skills_matching.height</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>unique_ids <span class="op">=</span> reversed_skills_matching.select(pl.col(<span class="st">"CANDIDATE_ID"</span>)).unique().height</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Unique CANDIDATE_ID: </span><span class="sc">{</span>unique_ids<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reverse Matchhing Candidates with CVs deleted: 248 out of 7769 total
That is 3.19% of all reverse matchhing candidates
Reverse Matchhing Candidates -&gt; Original rows: 7769
Reverse Matchhing Candidates -&gt; Dropped rows:  248 (IDs in provided list)
Reverse Matchhing Candidates -&gt; Remaining rows: 7521
Unique CANDIDATE_ID: 7521</code></pre>
</div>
</div>
<div id="65" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>missing_reversed_skills <span class="op">=</span> inspect_missing(reversed_skills_matching)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Missing value summary:
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (12, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">column</th>
<th data-quarto-table-cell-role="th">n_missing</th>
<th data-quarto-table-cell-role="th">pct_missing</th>
</tr>
<tr class="even">
<th>str</th>
<th>u32</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CANDIDATE_ID"</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>"Gender"</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>"Age_bucket"</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>"professional_categories_int"</td>
<td>7</td>
<td>0.09</td>
</tr>
<tr class="odd">
<td>"matterknowledges"</td>
<td>3818</td>
<td>50.76</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"candidatecity"</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>"drivinglicenses"</td>
<td>3586</td>
<td>47.68</td>
</tr>
<tr class="odd">
<td>"LONGITUDE"</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>"LATITUDE"</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>"experience"</td>
<td>2</td>
<td>0.03</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Columns with &gt; 0% missing values:
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">column</th>
<th data-quarto-table-cell-role="th">n_missing</th>
<th data-quarto-table-cell-role="th">pct_missing</th>
</tr>
<tr class="even">
<th>str</th>
<th>u32</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"professional_categories_int"</td>
<td>7</td>
<td>0.09</td>
</tr>
<tr class="even">
<td>"matterknowledges"</td>
<td>3818</td>
<td>50.76</td>
</tr>
<tr class="odd">
<td>"languages"</td>
<td>4011</td>
<td>53.33</td>
</tr>
<tr class="even">
<td>"regulatedtrainings"</td>
<td>4143</td>
<td>55.09</td>
</tr>
<tr class="odd">
<td>"drivinglicenses"</td>
<td>3586</td>
<td>47.68</td>
</tr>
<tr class="even">
<td>"experience"</td>
<td>2</td>
<td>0.03</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="analyze-demographic-data" class="level3">
<h3 class="anchored" data-anchor-id="analyze-demographic-data">Analyze demographic data</h3>
<p>Next, we examine the <strong>demographic columns</strong> (age, gender, and location) to spot correlations and identify any redundant fields.</p>
<div id="68" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>reversed_skills_matching <span class="op">=</span> reversed_skills_matching.with_columns(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    pl.when(pl.col(<span class="st">"LATITUDE"</span>) <span class="op">&gt;</span> <span class="fl">44.5</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    .then(pl.lit(<span class="st">"NORTH"</span>))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    .when(pl.col(<span class="st">"LATITUDE"</span>) <span class="op">&lt;</span> <span class="dv">42</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    .then(pl.lit(<span class="st">"SOUTH"</span>))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    .otherwise(pl.lit(<span class="st">"CENTER"</span>))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    .alias(<span class="st">"Location"</span>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After classifying candidates as North, Center, or South by latitude, we select the columns of interest and examine their inter-correlations to decide which ones to analyze next.</p>
<div id="70" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>reversed_skills_matching_filtered <span class="op">=</span> filter_unknown_and_other_rows(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    reversed_skills_matching</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>reversed_skills_matching_filtered <span class="op">=</span> reversed_skills_matching_filtered.select(</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gender"</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Age_bucket"</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Location"</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>reversed_skills_matching_filtered <span class="op">=</span> reversed_skills_matching_filtered.drop_nulls()</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>display(reversed_skills_matching_filtered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (7_404, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Gender</th>
<th data-quarto-table-cell-role="th">Age_bucket</th>
<th data-quarto-table-cell-role="th">Location</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Female"</td>
<td>"55-74"</td>
<td>"NORTH"</td>
</tr>
<tr class="even">
<td>"Female"</td>
<td>"55-74"</td>
<td>"CENTER"</td>
</tr>
<tr class="odd">
<td>"Female"</td>
<td>"55-74"</td>
<td>"NORTH"</td>
</tr>
<tr class="even">
<td>"Male"</td>
<td>"25-34"</td>
<td>"NORTH"</td>
</tr>
<tr class="odd">
<td>"Female"</td>
<td>"55-74"</td>
<td>"CENTER"</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"Female"</td>
<td>"55-74"</td>
<td>"NORTH"</td>
</tr>
<tr class="even">
<td>"Male"</td>
<td>"25-34"</td>
<td>"CENTER"</td>
</tr>
<tr class="odd">
<td>"Male"</td>
<td>"25-34"</td>
<td>"SOUTH"</td>
</tr>
<tr class="even">
<td>"Male"</td>
<td>"25-34"</td>
<td>"NORTH"</td>
</tr>
<tr class="odd">
<td>"Female"</td>
<td>"55-74"</td>
<td>"NORTH"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><strong>Building a Cramér’s V Association Matrix</strong></p>
<p>To find inter correlations, we compute a square matrix whose <em>(i, j)</em> entry is the Cramér’s V between column <em>i</em> and column <em>j</em> in <code>reversed_skills_matching</code>. (computed with polars-ds)</p>
<p>It normalises the χ² test of independence to the range [0, 1]:</p>
<p><span class="math display">\[
V \;=\; \sqrt{\frac{\chi^{2}}{\,n\bigl(k_{\min}-1\bigr)}}
\]</span></p>
<p>where</p>
<ul>
<li><strong>χ²</strong> is the chi-square statistic,</li>
<li><strong>n</strong> is the number of rows,</li>
<li><strong><span class="math inline">\(k_{\min}\)</span></strong> is the smaller of the two variables’ unique value counts.</li>
</ul>
<p>Thus <code>V = 0</code> means no association, <code>V = 1</code> means a perfect link.</p>
<div id="72" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>cramer_corrs <span class="op">=</span> [</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>        cramers_v(reversed_skills_matching_filtered, c1, c2)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> c2 <span class="kw">in</span> reversed_skills_matching_filtered.columns</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c1 <span class="kw">in</span> reversed_skills_matching_filtered.columns</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>cramer_matrix <span class="op">=</span> (</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    pl.DataFrame(cramer_corrs, schema<span class="op">=</span>reversed_skills_matching_filtered.columns)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    .with_columns(pl.Series(<span class="st">"index"</span>, reversed_skills_matching_filtered.columns))</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    .unpivot(index<span class="op">=</span><span class="st">"index"</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    .pivot(index<span class="op">=</span><span class="st">"index"</span>, on<span class="op">=</span><span class="st">"variable"</span>, values<span class="op">=</span><span class="st">"value"</span>)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    .sort(<span class="st">"index"</span>)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><strong>Attention!</strong><br>
The heat-map reveals a striking finding: <strong>Age Bucket and Gender are perfectly correlated (Cramér’s V = 1.0).</strong><br>
Since either variable fully determines the other, we will keep <strong>only one</strong> in subsequent analyses to avoid redundancy.</p>
</blockquote>
<div id="74" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>plot_cramer_matrix(cramer_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="data_cleaning_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The tables below makes this explicit: <strong>every female candidate is aged 55 – 74, while every male candidate is aged 25 – 34.</strong></p>
<div id="76" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>female_candidates <span class="op">=</span> reversed_skills_matching_filtered.<span class="bu">filter</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"Gender"</span>) <span class="op">==</span> <span class="st">"Female"</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>display(female_candidates[<span class="st">"Age_bucket"</span>].value_counts())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Age_bucket</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th>str</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"55-74"</td>
<td>3420</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="77" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>male_candidates <span class="op">=</span> reversed_skills_matching_filtered.<span class="bu">filter</span>(pl.col(<span class="st">"Gender"</span>) <span class="op">==</span> <span class="st">"Male"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>display(male_candidates[<span class="st">"Age_bucket"</span>].value_counts())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Age_bucket</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th>str</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"25-34"</td>
<td>3984</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="exporting-the-cleaned-data" class="level2">
<h2 class="anchored" data-anchor-id="exporting-the-cleaned-data">Exporting the Cleaned Data</h2>
<ul>
<li><strong>Export the cleaned CVs</strong>, the <strong>cleaned parsed skills</strong>, the <strong>cleaned matcher result</strong> to a <strong>new</strong> CSV file, ensuring the schema and data types are preserved.</li>
</ul>
<div id="80" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>raw_cv_cleaned.write_csv(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../data/Adecco_Dataset_cleaned/CV_translated_cleaned.csv"</span>, separator<span class="op">=</span><span class="st">";"</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>raw_skills_cleaned.write_csv(</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../data/Adecco_Dataset_cleaned/Skills_cleaned.csv"</span>, separator<span class="op">=</span><span class="st">";"</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>reversed_skills_matching.write_csv(</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../data/Adecco_Dataset_cleaned/reversed_skills_matching_candidate.csv"</span>,</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    separator<span class="op">=</span><span class="st">";"</span>,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Francesco Baiocchi &amp; Leonardo Petrilli</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/francescobaio/hiring_cv_bias">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/francesco-baiocchi-1aa2a2276/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>